{"version":3,"file":"st-map-list-block/view.js","mappings":"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","sources":["webpack://st-map-list-block/./src/st-map-list-block/view.js"],"sourcesContent":["/**\n * Use this file for JavaScript code that you want to run in the front-end\n * on posts/pages that contain this block.\n *\n * When this file is defined as the value of the `viewScript` property\n * in `block.json` it will be enqueued on the front end of the site.\n *\n * Example:\n *\n * ```js\n * {\n *   \"viewScript\": \"file:./view.js\"\n * }\n * ```\n *\n * If you're not making any changes to this file because your project doesn't need any\n * JavaScript running in the front-end, then you should delete this file and remove\n * the `viewScript` property from `block.json`.\n *\n * @see https://developer.wordpress.org/block-editor/reference-guides/block-api/block-metadata/#view-script\n */\n\n/* eslint-disable no-console */\n\ndocument.addEventListener('DOMContentLoaded', function() {\n\tconst button = document.getElementById('generate-btn');\n\tconst result = document.getElementById('result');\n\t\n\tif (button) {\n\t\tbutton.addEventListener('click', function() {\n\t\t\tconst randomNum = Math.floor(Math.random() * 100);\n\t\t\tresult.textContent = randomNum;\n\t\t\tconsole.log('Generated:', randomNum);\n\t\t});\n\t}\n});\n\n// console.log(\"data-sheet-id\", block.data-sheet-id)\nconst myData = document.getElementById(\"my-data\")\nconst sheetId = myData.getAttribute('data-sheet-id')\nconst sheetName = 'map-module'; // or your actual tab name\nconst url = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?sheet=${sheetName}`;\n\n// console.log(\"myData:\", myData)\n// console.log(\"DATA SHEET ID:\", sheetId)\n// console.log(\"url\", url)\n\n// clean json\nfetch(url)\n  .then((response) => response.text())\n  .then((text) => {\n    const jsonText = text.substring(47, text.length-2);\n    const json = JSON.parse(jsonText);\n    // console.log(json);\n\n    const rows = json.table.rows;\n    const headers = json.table.cols.map(col => col.label);\n\n    // console.log(rows)\n   const data = json.table.rows.map(r => {\n   const obj = {};\n      headers.forEach((header, i) => {\n        obj[header] = r.c[i]?.v ?? '';\n      });\n      return obj;\n    });\n\n    // console.log(\"clean data\", data);\n    // console.log(data[1].name);\n    // console.log(data.length);\n    addMarkers(data);\n    addSidebarItem(data);\n\n  })\n\nconst map = L.map('map')\nmap.setView([47.6108, -122.3307], 11);\n\nL.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png',{    \n     attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',     \n     crossOrigin: 'anonymous' }).addTo(map)\n\n\nlet markersArray = []\n\n// L.marker([47.661269, -122.342919], {\n//   title: \"Meowtropolitan Cafe\",\n// }).bindPopup('<h2>Meowtropolitan Cafe</h2>').addTo(map)\n\n\n\n// // Populate sidebar\n\nfunction addSidebarItem(locations){\n  sidebar = document.getElementById(\"sidebar-ul\")\n\n  for (let i = 0; i < locations.length; i++) {\n    var listItem = document.createElement(\"li\");\n    listItem.dataset.index = i;\n    listItem.dataset.place = locations[i].name; \n    listItem.classList.add(\"sidebar-li\")\n    sidebar.appendChild(listItem)\n\n    // Location title\n    var listItemTitle = document.createElement(\"h3\")\n    listItemTitle.classList.add(\"place-title\")\n    listItem.appendChild(listItemTitle)\n    listItemTitle.innerText = locations[i].name\n\n    // Location details\n    var listItemDetails = document.createElement(\"p\")\n    listItem.appendChild(listItemDetails)\n\n    listItemDetails.innerText = locations[i].address\n\n  }\n}\n\nfunction addMarkers(data){\n    markersArray = data.map(item => {\n      const marker = L.circleMarker([item.lat, item.long], {\n      radius: 8,  // Size of the circle\n      fillColor: \"#a1bca7\",\n      color: \"#6a9c75\",  // Border color\n      weight: 2,  // Border width\n      opacity: 1,\n      fillOpacity: 0.7,\n      title: item.name,\n      }) \n      .bindPopup(`<p class=\"popup-title\">${item.name}</p>\n        <div class=\"popup-details\">\n        ${item.blurb ? `<p>${item.blurb}</p>` : ''}\n        ${item.address ? `<p>${item.address}</p>` : ''}\n        ${item.price ? `<p>${item.price}</p>` : ''}\n        ${item.website ?`<a href=\"${item.website}\">Website</a>`: ''}\n        </div>`)\n      .addTo(map);\n\n      // click listener\n      marker.on(\"click\", function(e) {\n\n        const clickedMarker = e.target; // currently clicked marker\n        clickedMarker.openPopup(); // open popup\n\n        const clickedListItem = document.querySelector(`.sidebar-li[data-place=\"${item.name}\"]`); // find list item with same. name\n\n        document.querySelectorAll('.sidebar-li').forEach(item => \n      item.classList.remove('active')\n    );\n       \n        clickedListItem.classList.add(\"active\")\n        // clickedListItem.scrollIntoView({ behavior: \"smooth\", block: \"center\", inline: \"nearest\" })\n        // console.log(\"listItem- marker function\", clickedListItem)\n      const listItemTop = clickedListItem.offsetTop;\n      // console.log(\"listItemTop\", listItemTop)\n      // console.log(\"listItemTop bounding client rect\", clickedListItem.getBoundingClientRect().top)\n\n      const mapSidebar = document.getElementById('map-sidebar');\n\n      const sidebarRect = mapSidebar.getBoundingClientRect();\n      const listItemRect = clickedListItem.getBoundingClientRect();\n\n      const mapContainer = document.getElementById('map-container');\n      // console.log(\"mapContainer bounding client rect top\", mapContainer.getBoundingClientRect().top);\n      // console.log(\"mapContainer offsettop\", mapContainer.offsetTop);\n\n\n      const scrollAmount = listItemRect.top - mapContainer.top;\n      // console.log(\"scrollAmount\", scrollAmount)\n      // console.log(\"mapSidebar bounding client rect top\", mapSidebar.getBoundingClientRect().top)\n      // console.log(\"mapContainer bounding client rect top\", mapContainer.getBoundingClientRect().top)\n\n      // Scroll the sidebar (not the whole page)\n      // mapSidebar.scrollTo({\n      //   top: scrollAmount,\n      //   behavior: 'smooth'\n      // });\n\n      clickedListItem.scrollIntoView({block: \"center\", behavior: \"smooth\"})\n       })\n\n      return {name: item.name, marker} \n    });\n}\n\n// Handle user interaction\nfunction onListItemClick(e) {\n  const listItem = e.target.closest('.sidebar-li');\n  if (!listItem) return; // if you click somewhere besides a list item, do nothing\n  // console.log(\"listItem\", listItem)\n\n  // if list item is clicked, remove active class from everything and add it to the one that was clicked  \n  document.querySelectorAll('.sidebar-li').forEach(item => \n      item.classList.remove('active')\n    );\n    listItem.classList.add('active');\n\n    // Get list item placename \n    const placeName = listItem.dataset.place;\n    console.log(\"active item:\", placeName);\n    \n    map.closePopup();\n\n  // Find the corresponding marker and open its popup\n  const match = markersArray.find(m => m.name === placeName);\n  if (match) {\n    match.marker.openPopup();\n  } \n  }\n\nwindow.addEventListener(\"click\", onListItemClick);\n"],"names":["document","addEventListener","button","getElementById","result","randomNum","Math","floor","random","textContent","console","log","myData","sheetId","getAttribute","sheetName","url","fetch","then","response","text","jsonText","substring","length","json","JSON","parse","rows","table","headers","cols","map","col","label","data","r","obj","forEach","header","i","_r$c$i$v","c","v","addMarkers","addSidebarItem","L","setView","tileLayer","attribution","crossOrigin","addTo","markersArray","locations","sidebar","listItem","createElement","dataset","index","place","name","classList","add","appendChild","listItemTitle","innerText","listItemDetails","address","item","marker","circleMarker","lat","long","radius","fillColor","color","weight","opacity","fillOpacity","title","bindPopup","blurb","price","website","on","e","clickedMarker","target","openPopup","clickedListItem","querySelector","querySelectorAll","remove","listItemTop","offsetTop","mapSidebar","sidebarRect","getBoundingClientRect","listItemRect","mapContainer","scrollAmount","top","scrollIntoView","block","behavior","onListItemClick","closest","placeName","closePopup","match","find","m","window"],"sourceRoot":""}