{"version":3,"file":"st-map-list-block/view.js","mappings":"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","sources":["webpack://st-map-list-block/./src/st-map-list-block/view.js"],"sourcesContent":["/**\n * Use this file for JavaScript code that you want to run in the front-end\n * on posts/pages that contain this block.\n *\n * When this file is defined as the value of the `viewScript` property\n * in `block.json` it will be enqueued on the front end of the site.\n *\n * Example:\n *\n * ```js\n * {\n *   \"viewScript\": \"file:./view.js\"\n * }\n * ```\n *\n * If you're not making any changes to this file because your project doesn't need any\n * JavaScript running in the front-end, then you should delete this file and remove\n * the `viewScript` property from `block.json`.\n *\n * @see https://developer.wordpress.org/block-editor/reference-guides/block-api/block-metadata/#view-script\n */\n\n/* eslint-disable no-console */\n\ndocument.addEventListener('DOMContentLoaded', function() {\n\tconst button = document.getElementById('generate-btn');\n\tconst result = document.getElementById('result');\n\t\n\tif (button) {\n\t\tbutton.addEventListener('click', function() {\n\t\t\tconst randomNum = Math.floor(Math.random() * 100);\n\t\t\tresult.textContent = randomNum;\n\t\t\tconsole.log('Generated:', randomNum);\n\t\t});\n\t}\n});\n\n// console.log(\"data-sheet-id\", block.data-sheet-id)\nconst myData = document.getElementById(\"my-data\")\nconst sheetId = myData.getAttribute('data-sheet-id')\nconst sheetName = 'map-module'; // or your actual tab name\nconst url = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?sheet=${sheetName}`;\n\n// console.log(\"myData:\", myData)\n// console.log(\"DATA SHEET ID:\", sheetId)\n// console.log(\"url\", url)\n\n// clean json\nfetch(url)\n  .then((response) => response.text())\n  .then((text) => {\n    const jsonText = text.substring(47, text.length-2);\n    const json = JSON.parse(jsonText);\n    // console.log(json);\n\n    const rows = json.table.rows;\n    const headers = json.table.cols.map(col => col.label);\n\n    // console.log(rows)\n   const data = json.table.rows.map(r => {\n   const obj = {};\n      headers.forEach((header, i) => {\n        obj[header] = r.c[i]?.v ?? '';\n      });\n      return obj;\n    });\n\n    console.log(\"clean data\", data);\n    console.log(data[1].name);\n    console.log(data.length);\n    addMarkers(data);\n    addSidebarItem(data);\n\n  })\n\nconst map = L.map('map')\nmap.setView([47.6108, -122.3307], 11);\n\nL.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png',{    \n     attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',     \n     crossOrigin: 'anonymous' }).addTo(map)\n\n\nlet markersArray = []\n\n// L.marker([47.661269, -122.342919], {\n//   title: \"Meowtropolitan Cafe\",\n// }).bindPopup('<h2>Meowtropolitan Cafe</h2>').addTo(map)\n\n\n\n// // Populate sidebar\n\nfunction addSidebarItem(locations){\n  sidebar = document.getElementById(\"sidebar-ul\")\n\n  for (let i = 0; i < locations.length; i++) {\n    var listItem = document.createElement(\"li\");\n    listItem.dataset.index = i;\n    listItem.dataset.place = locations[i].name; \n    listItem.classList.add(\"sidebar-li\")\n    sidebar.appendChild(listItem)\n\n    // Location title\n    var listItemTitle = document.createElement(\"h3\")\n    listItemTitle.classList.add(\"place-title\")\n    listItem.appendChild(listItemTitle)\n    listItemTitle.innerText = locations[i].name\n\n    // Location details\n    var listItemDetails = document.createElement(\"p\")\n    listItem.appendChild(listItemDetails)\n\n    listItemDetails.innerText = locations[i].address\n\n  }\n}\n\nfunction addMarkers(data){\n    markersArray = data.map(item => {\n      const marker = L.circleMarker([item.lat, item.long], {\n      radius: 8,  // Size of the circle\n      fillColor: \"#a1bca7\",\n      color: \"#6a9c75\",  // Border color\n      weight: 2,  // Border width\n      opacity: 1,\n      fillOpacity: 0.7,\n      title: item.name,\n      }) \n      .bindPopup(`<p class=\"popup-title\">${item.name}</p><p class=\"popup-details\">${item.address}</p>`)\n      .addTo(map);\n\n      // click listener\n      marker.on(\"click\", function(e) {\n\n        const clickedMarker = e.target; // currently clicked marker\n        clickedMarker.openPopup(); // open popup\n\n        const clickedListItem = document.querySelector(`.sidebar-li[data-place=\"${item.name}\"]`); // find list item with same. name\n\n        document.querySelectorAll('.sidebar-li').forEach(item => \n      item.classList.remove('active')\n    );\n       \n        clickedListItem.classList.add(\"active\")\n        clickedListItem.scrollIntoView({ behavior: \"smooth\", block: \"center\", inline: \"nearest\" })\n        console.log(\"listItem- marker function\", clickedListItem)\n        \n\n       })\n      return {name: item.name, marker} \n    });\n}\n\n// Handle user interaction\nfunction onListItemClick(e) {\n  const listItem = e.target.closest('.sidebar-li');\n  if (!listItem) return; // if you click somewhere besides a list item, do nothing\n  console.log(\"listItem\", listItem)\n\n  // if list item is clicked, remove active class from everything and add it to the one that was clicked  \n  document.querySelectorAll('.sidebar-li').forEach(item => \n      item.classList.remove('active')\n    );\n    listItem.classList.add('active');\n\n    // Get list item placename \n    const placeName = listItem.dataset.place;\n    console.log(\"active item:\", placeName);\n    \n    map.closePopup();\n\n  // Find the corresponding marker and open its popup\n  const match = markersArray.find(m => m.name === placeName);\n  if (match) {\n    match.marker.openPopup();\n  } \n  }\n\nwindow.addEventListener(\"click\", onListItemClick);\n"],"names":["document","addEventListener","button","getElementById","result","randomNum","Math","floor","random","textContent","console","log","myData","sheetId","getAttribute","sheetName","url","fetch","then","response","text","jsonText","substring","length","json","JSON","parse","rows","table","headers","cols","map","col","label","data","r","obj","forEach","header","i","_r$c$i$v","c","v","name","addMarkers","addSidebarItem","L","setView","tileLayer","attribution","crossOrigin","addTo","markersArray","locations","sidebar","listItem","createElement","dataset","index","place","classList","add","appendChild","listItemTitle","innerText","listItemDetails","address","item","marker","circleMarker","lat","long","radius","fillColor","color","weight","opacity","fillOpacity","title","bindPopup","on","e","clickedMarker","target","openPopup","clickedListItem","querySelector","querySelectorAll","remove","scrollIntoView","behavior","block","inline","onListItemClick","closest","placeName","closePopup","match","find","m","window"],"sourceRoot":""}